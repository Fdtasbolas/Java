<html>
<head>
<link href="./styles/reset.css" media="all" rel="stylesheet" type="text/css"/>
<link href="./styles/base.css" media="all" rel="stylesheet" type="text/css"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="cordova-2.4.0.js"></script>
<script src="./scripts/handlebars.js" type="text/javascript"></script>
<script id="apartmentList-template" type="text/x-handlebars-template">
<div class="map-view">
	<div class="results fl">
	  {{#each .}}
		<div class="listing basic">
			<div class="photo thumb"> 
				<a href="#"><img src="{{LThumbnailUrl}}" /></a>
			</div>
			<div class="summary two-thirds al" >
				<span class="name fl cb"> 
					  <a href="#" package-level="{{PackageLevel}}">{{Name}}</a>
				</span>
				<div class="clr"></div>
				<div class="info fl">
					<address class="address"><span class="street">{{Address}}, </span>{{City}}, {{State}} {{Zip}}<a class="sm-txt dn" href=""> Map</a></address>
					<div class="breakdown-range">
						<ul>
							<li><span class="room"><span>{{MinBedrooms}}</span> - <span>{{MaxBedrooms}} BR</span></span></li>
							<li><span class="price"><a href="#">{{NetMinPrice}}</a></span></li>
						</ul>
						<div class="clr"></div>
					</div>
					<div>
						<span class="phone spc">{{Phone}}</span> 
					</div>
				</div>
			</div>
			<div class="clr"></div>
		</div>
	  {{/each}}
	</div>
</div>
</script>
<script language="javascript">
	var searchObject;
	$(document).ready(function ($) {
		searchObject = {
							"SearchParameters":{
								"SearchType":"CITY",
								"ParameterList":{"City":"Athens","State":"GA"}
							},
							"SearchField":"*",
							"SearchTerm":"*",
							"NumberOfRows":20,
							"StartPage":1,
							"RandomSeed":0,
							"RequestType":"ProximitySearchRequest",
							"BoostFeaturedListings":true,
							"BoostRange":{"Key":0,"Min":10,"Max":40,"Active":false},
							"Facets":{
								"FieldList":["ApartmentFeatures","CommunityFeatures"],
								"QueryList":[],
								"Limit":10
							},
							"Criteria":[],
							"ApartmentFeatures":[],
							"CommunityFeatures":[],
							"SortBy":"",
							"ExcludeGhostListings":false,
							"BoostODX":false
						};
		search(searchObject);
	});
	
	function search(p_SearchData) {
		$.ajax({
			url: 'http://service.lc.com/Apartments/Search',
			dataType: 'jsonp',
			data: p_SearchData,
			success: searchCallback,
            error: function (xhr, textStatus, errorString) {
                console.log(textStatus);
                console.log(errorString);
            }
		});
	}
	
	function searchCallback(data){
		var source   = $("#apartmentList-template").html();
		var template = Handlebars.compile(source);
		$("body").append( template(data.response.docs) );
	}
</script>
</head>
<body>
<section class="search">
	<div class="ui-widget">
        <input autocomplete="off" id="SearchText" name="SearchText" type="text" />
		<input class="btn-search" type="button" value="" />
	</div>
	<div class="clr"></div>
</section>
</body>
</html>